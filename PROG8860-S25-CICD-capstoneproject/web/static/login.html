<div class="auth-container">
    <div class="alert" ng-class="{'alert-error': data.message}" ng-if="data.message">
        {{ data.message }}
    </div>

    <div ng-if="data.user.name === undefined" class="auth-forms">
        <div class="login-form">
            <h2>Sign In</h2>
            <div class="form-group">
                <label>Username</label>
                <input type="text" ng-model="data.name" class="form-input" placeholder="Enter your username"/>
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" ng-model="data.password" class="form-input" placeholder="Enter your password"/>
            </div>
            <button ng-click="login()" class="btn-primary">Login</button>
        </div>

        <div class="register-form">
            <h2>Create Account</h2>
            <div class="form-group">
                <label>Username</label>
                <input type="text" ng-model="data.name" class="form-input" placeholder="Choose a username"/>
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" ng-model="data.email" class="form-input" placeholder="Enter your email"/>
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" ng-model="data.password" class="form-input" placeholder="Create a password"/>
            </div>
            <div class="form-group">
                <label>Confirm Password</label>
                <input type="password" ng-model="data.password2" class="form-input" placeholder="Confirm your password"/>
            </div>
            <button ng-click="register()" class="btn-primary">Register</button>
        </div>
    </div>

    <div ng-if="data.user.name !== undefined" class="account-dashboard">
        <div class="account-header">
            <h2>Welcome back, {{ data.user.name }}!</h2>
            <p><i class="fas fa-envelope"></i> {{ data.user.email }}</p>
        </div>
        
        <div class="order-history">
            <h3>Your Order History</h3>
            <div ng-if="!data.orderHistory || data.orderHistory.length === 0" class="no-orders">
                <p>You haven't placed any orders yet.</p>
                <a href="/" class="btn-primary">Start Shopping</a>
            </div>
            
            <div ng-if="data.orderHistory && data.orderHistory.length > 0" class="orders-list">
                <div class="order-card" ng-repeat="hist in data.orderHistory">
                    <div class="order-header">
                        <span class="order-id">Order #{{ hist.orderid }}</span>
                        <span class="order-total">€{{ hist.cart.total.toFixed(2) }}</span>
                    </div>
                    <div class="order-items">
                        <div class="order-item" ng-repeat="item in hist.cart.items">
                            {{ item.name }} ({{ item.qty }} × €{{ (item.subtotal/item.qty).toFixed(2) }})
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>